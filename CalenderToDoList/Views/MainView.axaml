<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:CalenderToDoList.ViewModels"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
             x:Class="CalenderToDoList.Views.MainView"
             x:DataType="vm:MainViewModel">

  <Design.DataContext>
    <vm:MainViewModel />
  </Design.DataContext>

  <Grid ColumnDefinitions="250, *">

    <!-- å·¦ä¾§å¯¼èˆªæ  -->
    <Border Grid.Column="0" Background="#f9f9f9" BorderBrush="#e5e5e5" BorderThickness="0,0,1,0">
      <Grid RowDefinitions="*, Auto" Margin="0,50,0,10">
        <StackPanel Grid.Row="0">
          <TextBlock Text="CalenderToDoList" Margin="10,0,0,20" FontWeight="Bold" Foreground="#2564cf" FontSize="26"/>
          <ListBox Background="Transparent" BorderThickness="0">
            <ListBoxItem Content="ä»»åŠ¡" Padding="20,10" IsSelected="True"/>
          </ListBox>
        </StackPanel>

        <StackPanel Grid.Row="1" Spacing="2" Margin="10,0,10,10">
          <Button HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Background="Transparent" Padding="10,8" Command="{Binding ExportIcsCommand}">
            <StackPanel Orientation="Horizontal">
              <TextBlock Text="ðŸ“…" Margin="0,0,10,0"/>
              <TextBlock Text="å¯¼å‡ºä¸º .ics æ–‡ä»¶" VerticalAlignment="Center" FontSize="14"/>
            </StackPanel>
          </Button>

          <Button HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Background="Transparent" Padding="10,8" Foreground="#d13438" Command="{Binding ExitAppCommand}">
            <StackPanel Orientation="Horizontal">
              <TextBlock Text="ðŸšª" Margin="0,0,10,0"/>
              <TextBlock Text="é€€å‡ºç¨‹åº" VerticalAlignment="Center" FontSize="14"/>
            </StackPanel>
          </Button>
        </StackPanel>
      </Grid>
    </Border>

    <!-- å³ä¾§ä¸»å†…å®¹åŒº -->
    <Border Grid.Column="1" Background="#f3f3f3" Padding="30,50,30,20">
      <Grid RowDefinitions="Auto, *, Auto">
        <TextBlock Grid.Row="0" Text="å¾…åŠžæ¸…å•" FontSize="24" FontWeight="SemiBold" Foreground="#2564cf" Margin="0,0,0,20"/>

        <!-- ä»»åŠ¡åˆ—è¡¨ -->
        <ScrollViewer Grid.Row="1">
          <ItemsControl ItemsSource="{Binding TodoItems}">
            <ItemsControl.ItemTemplate>
              <DataTemplate>
                <Border Background="White" CornerRadius="5" Margin="0,0,0,5" BoxShadow="0 1 3 0 #10000000">
                  <Grid ColumnDefinitions="Auto, *" Margin="10">
                    <CheckBox Grid.Column="0" IsChecked="{Binding IsDone}" VerticalAlignment="Center"/>

                    <!-- ã€ä¿®æ”¹ç‚¹ 1ã€‘ä½¿ç”¨ StackPanel å®žçŽ°æ–‡å­—åœ¨ä¸Šï¼Œæ—¥æœŸåœ¨ä¸‹ -->
                    <StackPanel Grid.Column="1" Margin="10,0" VerticalAlignment="Center">
                      <!-- ä»»åŠ¡å†…å®¹ -->
                      <TextBlock Text="{Binding TaskContent}" FontSize="16" FontWeight="Normal"/>

                      <!-- æ—¥æœŸä¿¡æ¯ï¼šå­—å·æ›´å°ï¼Œé¢œè‰²ä¸ºç°è‰²ï¼Œä»…åœ¨æœ‰æ—¥æœŸæ—¶æ˜¾ç¤º -->
                      <StackPanel Orientation="Horizontal" Margin="0,2,0,0"
                                  IsVisible="{Binding DeadLine, Converter={x:Static ObjectConverters.IsNotNull}}">
                        <TextBlock Text="ðŸ“…" FontSize="10" Foreground="Gray" Margin="0,0,5,0" VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding DeadLine, StringFormat='\{0:yyyy/MM/dd\}'}"
                                   FontSize="12"
                                   Foreground="Gray"
                                   VerticalAlignment="Center"/>
                      </StackPanel>
                    </StackPanel>
                  </Grid>
                </Border>
              </DataTemplate>
            </ItemsControl.ItemTemplate>
          </ItemsControl>
        </ScrollViewer>

        <!-- åº•éƒ¨è¾“å…¥æ¡† -->
        <Border Grid.Row="2" Background="White" CornerRadius="5" Padding="5" Margin="0,10,0,0">
          <Grid ColumnDefinitions="*, Auto, Auto, Auto">

            <!-- ã€ä¿®æ”¹ç‚¹ 2ã€‘TextBox ç‹¬ç«‹å‡ºæ¥ï¼Œä¸å†åŒ…è£¹å…¶ä»–æŽ§ä»¶ -->
            <TextBox Grid.Column="0"
                     Text="{Binding NewTaskContent}"
                     Watermark="æ·»åŠ ä»»åŠ¡"
                     BorderThickness="0"
                     VerticalContentAlignment="Center"
                     Background="Transparent">
              <TextBox.KeyBindings>
                <KeyBinding Gesture="Enter" Command="{Binding AddTaskCommand}" />
              </TextBox.KeyBindings>
            </TextBox>

            <!-- ã€ä¿®æ”¹ç‚¹ 3ã€‘DatePicker æ”¾åœ¨ TextBox åŽé¢ï¼Œå ç‹¬ç«‹çš„ä¸€åˆ— -->
            <CalendarDatePicker Grid.Column="1"
                                SelectedDate="{Binding NewTaskDate}"
                                Watermark="æˆªæ­¢æ—¥æœŸ"
                                BorderThickness="0"
                                Background="Transparent"
                                VerticalAlignment="Center"
                                Margin="5,0"/>

            <Button Grid.Column="2"
                    Command="{Binding DeleteLastTaskCommand}"
                    Background="Transparent"
                    BorderThickness="0"
                    Width="35" Height="35"
                    VerticalAlignment="Center">
              <TextBlock Text="ðŸ—‘ï¸" FontSize="16" Foreground="#d13438" HorizontalAlignment="Center"/>
            </Button>

            <Button Grid.Column="3"
                    Command="{Binding AddTaskCommand}"
                    Background="Transparent"
                    BorderThickness="0"
                    Width="35" Height="35"
                    VerticalAlignment="Center">
              <TextBlock Text="+" FontSize="20" FontWeight="Bold" Foreground="#2564cf" HorizontalAlignment="Center"/>
            </Button>
          </Grid>
        </Border>

      </Grid>
    </Border>

  </Grid>
</UserControl>